#####################################################################
## MOD Title: Advanced BBCode Box 3 ( aka ABBC3 )
##
## MOD Author: leviatan21 < info@mssti.com > (Gabriel) http://www.mssti.com/phpbb2/
## MOD Author: Disturbed One < anthony@anthonycoy.com > (Anthony Coy) http://www.hvmdesign.com
## MOD Author: AL Tnen < al_tnen@hotmail.com > (N/A) http://www.tnen.zzn.com
## MOD Author: freddie < freddie@tactic.be > (Stefaan Van Damme) http://www.tactic.be
##
## MOD Description: ABBC3 MOD adds lots of useful BBCode features and makes the bbcode buttons
##		look just like Microsoft Office. It also improves the functions of
##		phpBB's BBCode function. It adds the bbcode exactly where the cursor is,
##		inserts smilies where the cursor is, and adds more ways to customize posts.
##		The MOD is very fast loading, and is a sleek addition to your phpBB bulletin board.
##		You must have javascript enabled to use this MOD.
##
## MOD Version: 1.0.6b
##
## Installation Level: Easy
## Installation Time: ~10 Minutes
##
## Files To Edit:
##	common.php
##	includes/functions.php
##	includes/functions_content.php
##	styles/prosilver/template/overall_header.html
##	styles/prosilver/template/posting_buttons.html
##	styles/subsilver2/template/overall_header.html
##	styles/subsilver2/template/posting_buttons.html
##
## Included Files:
##	includes/abbcode.php
##	language/en/mods/abbcode.php
##	styles/prosilver/*.*
##	styles/subsilver2/*.*
##
## License: http://opensource.org/licenses/gpl-license.php GNU General Public License v2 
#####################################################################
## For security purposes, please check: http://www.phpbb.com/mods/
## for the latest version of this MOD. Although MODs are checked
## before being allowed in the MODs Database there is no guarantee
## that there are no security problems within the MOD. No support
## will be given for MODs not found within the MODs Database which
## can be found at http://www.phpbb.com/mods/
#####################################################################
## Author Notes:
##
##	I contacted "Disturbed One" the original developer of this mod 
##	 and "freddie" the last developer of this mod, 
##	 and ask for upgrade the Advanced BBcode Box for phpbb2.x to phpbb3.0.0, 
##	 Both say that they will not do the job, and are agree that I do it, 
##	 so here I am ;)
##	
##	Phpbb3 posting page use javascript, basically to add tags to the textarea, 
##	 when you click on a button javascript insert the code into the post text.
##	 ABBC works in the same way, and add more javascript funtions to the wizards...
##	 Apart from that the only function that need extra javascript is the fade tag.
##
##	Please do not remove the copyright notice located on the box without my permission.
##
##	Tested on Windows Browsers:
##	- Internet Explorer 7.0
##	- Mozilla Firefox 2.0
##	- Opera 9.1
##	- Safari 3.0
##	- Netscape 8.1
##
##	List of all included :
##	- Font Type Dropdown
##	- Font Size Dropdown
##	- Highlight Font Color Dropdown
##	- Justify Align
##	- Left Align
##	- Center Align
##	- Right Align
##	- Preformat text
##	- Superscript
##	- Subscript
##	- Bold
##	- Italic
##	- Underline
##	- Strikethrough
##	- Text Fade
##	- Text Gradient
##	- Message Box text direction Left to Light (Traditional)
##	- Message Box text direction right to Left (Arabic, etc)
##	- Marquee Down
##	- Marquee Up
##	- Marquee Left
##	- Marquee Right
##	- Table row cell wizard
##	- Code
##	- Quote
##	- Spoiler (User must click on link to review text within tags)
##	- Ed2k link Wizard
##	- Hyperlink Wizard
##	- Email Wizard
##	- Web included by iframe
##	- Image Wizard
##	- Thumbnail
##	- Imgshack
##	- Flash Wizard
##	- Streaming Video/Audio Wizard
##	- Ram Wizard
##	- Quick time
##	- Stage6 video Wizard
##	- Google video Wizard
##	- Youtube video  Wizard
##	- Unordered List Wizard
##	- Ordered List Wizard
##	- Line Break
##	- Cut selected text
##	- Copy selected text
##	- Paste previously copy text
##	- Remove BBCode (Removes all BBCode tags from selected text)
##
##	EasyMOD
##	-----------
##	This MOD is NOT Tested with EasyMod
##
##	SQL commands
##	-----------
##	This MOD No need a database install/update.
##
##	Translation
##	-----------
##	See contrib/language folder
##	en [English] updated
##	es [Spanish] updated
##	bg [Bulgarian] new! updated
##	fr_x_strict [Francais] updated
##	nl [Dutch] new! updated
##	pl [Polish] updated
##	pt_br [Português Brasil] updated
##	pt-pt [Português Português] updated
##	tr [Turkish]
##
##	Official last version
##	-----------
##	Meanwhile the phpBB group validation and as the MOD is not yet
##	in the phpBB MOD database, check this official link for updates...
##	http://www.mssti.com/phpbb3/index.php
##	If you want to test this board, you can use a demo acount :
##	Please visit : http://www.mssti.com/phpbb3/viewtopic.php?f=2&t=1
##
#####################################################################
## MOD History: see contrib/updates folder	
##
##	2008-02-03 - Version 1.0.6b
##	- New installation method
##	- Fixed PM's with ABBC3. ( Thanks mej284 )
##	- Fixed show custom bbcodes from a how-to-add in 'posting_abbcodes_buttons.html' files ( Thanks joebart72 )
##	- Added 2 pre installed custom bbcodes : Dailymotion and Moderator, both are disabled by default.
##
##	2008-01-31 - Version 1.0.6
##	- New installation method
##	- New config, you can enable/disable each one tags, regardless. By default all are enables
##	   please open includes/abbcode.php and look at $abbcode_config = array()
##	- Fixed if text is selected and clik on a tag, the wizard is not displayed 
##	   and instead add the selected bbcode. ( excepted table bbcode ) 
##	- Parsing abbcodes improved, now it's more fast
##	- Fixed bug table parsing.
##	- Added wizard examples, please open language/en/mods/abbcode.php
##	   and look at all 'ABBCODE_?????_NOTE'				=> and add/change to your own examples ;)
##	- Fixed wizards no description imput. ( Thanks pavabe )
##	- Fixed wizard email ( Thanks pavabe )
##	- Fixed style/subsilver2/posting_button.html ( Thanks mej284 )
##	- Fixed video + Real Player + stream tags.
##	- Added new typo thumbnail
##	- Added new typo quick time
##	- Fixed the copyright link ( Thanks joebart72 )
##	- Fixed a misspell in language/en/mods/abbcode.php ( Thanks pavabe ) 
##
##	2008-01-25 - Version 1.0.5  ( Thanks mej284 )
##	- Fixed overall_header.html javascript call.
##	- Fixed grad color bug for IE
##	- Fixed bug install.txt file
##
##	2008-01-18 - Version 1.0.4
##	- Added security on laguages files.
##	- Renewed wizards.
##	- Added/renewed font styles.
##	- Added imageshack upload.
##	- Fixed video + Real Player + stream tags.
##	- Fixed grad color. ( Thanks ThunderCrew )
##	- Fixed table.
##	- Improve cosmetic issue.
##
##	2008-01-15 - Version 1.0.3
##	- Fix in subsilver posting_abbcodes_buttons.html.
##	- Added contrib/add-on folder with Quick reply info.
##	- Fixed private message bugs. ( Thanks El_Vindicador )
##	- Fixed others minor bugs.
##
##	2008-01-14 - Version 1.0.2
##	- Change folder placement ( Suggested by MrC ).
##	- Added languaje file.
##	- Changed highlight dropdown colors with phpbb colors.
##	- Change the copyright link to image link.
##	- Added Giant font size (you must go ACP -> General Tab -> Board configuration -> Post settings
##		look at 
##		"Maximum font size per post:
##		 Maximum font size allowed in a post. Set to 0 for unlimited font size."
##		and change 200 value with 300)
##
##	2008-01-11 - Version 1.0.1
##	- Added typo Pre.
##	- Adder table wizard ( Suggested by ahmedgroup ).
##	- Fixed Gradient.
##	- Fixed added codes buttons from phpbb3 ACP.
##
##	2008-01-10 - Version 1.0.0
##	- Upgrade from phpbb2.x to phpbb3.0.0 (Gold)
##
#####################################################################
## Before Adding This MOD To Your Forum, You Should Back Up All Files Related To This MOD
#####################################################################
#
#-----[ COPY ]-------------------------------------------------------
#
copy root/includes/abbcode.php         to includes/abbcode.php
copy root/language/en/mods/abbcode.php to language/en/mods/abbcode.php
copy root/styles/prosilver/*.*         to styles/prosilver/*.*
copy root/styles/subsilver2/*.*        to styles/subsilver2/*.*

#
#-----[ OPEN ]-------------------------------------------------------
#
common.php

#
#-----[ FIND ]-------------------------------------------------------
#
// Set PHP error handler to ours

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find.
#
// MOD : ABBC3 (V1.0.6b) - START
require($phpbb_root_path . 'includes/abbcode.' . $phpEx);
// MOD : ABBC3 (V1.0.6b) - END

#
#-----[ OPEN ]-------------------------------------------------------
#
includes/functions.php

#
#-----[ FIND ]-------------------------------------------------------
#
	// The following assigns all _common_ variables that may be used at any point in a template.

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find.
#
	// MOD : ABBC3 (V1.0.6b) - START
	display_abbc3();
	// MOD : ABBC3 (V1.0.6b) - END

#
#-----[ OPEN ]-------------------------------------------------------
#
includes/functions_content.php

#
#-----[ FIND ]-------------------------------------------------------
#
function smiley_text($text, $force_option = false)
{
	global $config, $user, $phpbb_root_path;

#
#-----[ AFTER, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line after the preceding line(s) to find.
#
	// MOD : ABBC3 (V1.0.6b) - START
	$text = process_abbc3($text);
	// MOD : ABBC3 (V1.0.6b) - END

#
#-----[ OPEN ]-------------------------------------------------------
# NOTE: You will have to make this change to ALL themes you have installed. I use "prosilver" as an example.
#
styles/prosilver/template/overall_header.html

#
#-----[ FIND ]-------------------------------------------------------
#
</head>

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find.
#

<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/bbcode_box.js" charset="{S_CONTENT_ENCODING}"></script>
<!-- IF S_ABBC3_LITEBOX -->
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/lightbox/prototype.lite.js"></script>
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/lightbox/moo.fx.js"></script>
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/lightbox/litebox-1.0.js"></script>
<script type="text/javascript">
	var fileLoadingImage = "{T_IMAGESET_PATH}/bbcode_box/lightbox/loading.gif";
	var fileBottomNavCloseImage = "{T_IMAGESET_PATH}/bbcode_box/lightbox/closelabel.gif";
</script>
<!-- ENDIF -->

<style type="text/css" media="all">
@import "{T_IMAGESET_PATH}/bbcode_box/stylesheet.css";
@import "{T_IMAGESET_PATH}/bbcode_box/lightbox/lightbox.css";
</style>
<!-- // MOD : ABBC3 (V1.0.6b) - END -->

#
#-----[ FIND ]-------------------------------------------------------
#
<body id="phpbb" class="section-{SCRIPT_NAME} {S_CONTENT_DIRECTION}">

#
#-----[ IN-LINE FIND ]------------------------------------------
#
>

#
#-----[ IN-LINE BEFORE, ADD ]------------------------------------------
#
<!-- IF S_ABBC3_LITEBOX --> onload="initLightbox()" <!-- ENDIF -->

#
#-----[ OPEN ]-------------------------------------------------------
# NOTE: You will have to make this change to ALL themes you have installed. I use "prosilver" as an example.
#
styles/prosilver/template/posting_buttons.html

#
#-----[ FIND ]-------------------------------------------------------
#
<div id="format-buttons">

#
#-----[ AFTER, ADD ]-------------------------------------------------
# NOTE: Add these lines on a new blank line after the preceding line(s) to find. 
#
<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<!-- IF S_ABBC3_MOD -->
	<!-- INCLUDE posting_abbcodes_buttons.html -->
<!-- ELSE -->
<!-- // MOD : ABBC3 (V1.0.6b) - END -->

#
#-----[ FIND ]-------------------------------------------------------
#
</div>
<!-- ENDIF -->

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find. 
#
<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<!-- ENDIF -->
<!-- // MOD : ABBC3 (V1.0.6b) - END -->
#
#-----[ OPEN ]-------------------------------------------------------
# NOTE: You will have to make this change to ALL themes you have installed. I use "subsilver2" as an example.
#
styles/subsilver2/template/overall_header.html

#
#-----[ FIND ]-------------------------------------------------------
#
</head>

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find. 
#
<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/bbcode_box.js" charset="{S_CONTENT_ENCODING}"></script>
<!-- IF S_ABBC3_LITEBOX -->
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/lightbox/prototype.lite.js"></script>
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/lightbox/moo.fx.js"></script>
<script type="text/javascript" src="{T_IMAGESET_PATH}/bbcode_box/lightbox/litebox-1.0.js"></script>
<script type="text/javascript">
// <![CDATA[
	var fileLoadingImage = "{T_IMAGESET_PATH}/bbcode_box/lightbox/loading.gif";
	var fileBottomNavCloseImage = "{T_IMAGESET_PATH}/bbcode_box/lightbox/closelabel.gif";
// ]]>
</script>
<!-- ENDIF -->

<style type="text/css" media="all">
@import "{T_IMAGESET_PATH}/bbcode_box/stylesheet.css";
@import "{T_IMAGESET_PATH}/bbcode_box/lightbox/lightbox.css";
</style>
<!-- // MOD : ABBC3 (V1.0.6b) - END -->

#
#-----[ FIND ]-------------------------------------------------------
#
<body class="{S_CONTENT_DIRECTION}">

#
#-----[ IN-LINE FIND ]------------------------------------------
#
>

#
#-----[ IN-LINE BEFORE, ADD ]------------------------------------------
#
<!-- IF S_ABBC3_LITEBOX --> onload="initLightbox()" <!-- ENDIF -->

#
#-----[ OPEN ]-------------------------------------------------------
# NOTE: You will have to make this change to ALL themes you have installed. I use "subsilver2" as an example.
#
styles/subsilver2/template/posting_buttons.html

#
#-----[ FIND ]-------------------------------------------------------
# NOTE: This line appears twice, but we will use only the first match.
<!-- IF S_BBCODE_ALLOWED -->

#
#-----[ AFTER, ADD ]-------------------------------------------------
# NOTE: Add these lines on a new blank line after the preceding line(s) to find. 
#
<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<!-- IF S_ABBC3_MOD -->
	<!-- INCLUDE posting_abbcodes_buttons.html -->
<!-- ELSE -->
<!-- // MOD : ABBC3 (V1.0.6b) - END -->

#
#-----[ FIND ]-------------------------------------------------------
#
<!-- ENDIF -->
	</td>
</tr>

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find. 
#
<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<!-- ENDIF -->
<!-- // MOD : ABBC3 (V1.0.6b) - END -->

#
#-----[ FIND ]-------------------------------------------------------
#
<!-- IF S_BBCODE_ALLOWED and .custom_tags -->

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find. 
#
<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<!-- IF S_ABBC3_MOD -->
	<!-- nothing happend -->
<!-- ELSE -->
<!-- // MOD : ABBC3 (V1.0.6b) - END -->

#
#-----[ FIND ]-------------------------------------------------------
#
<!-- IF S_BBCODE_ALLOWED -->
<tr>

#
#-----[ BEFORE, ADD ]------------------------------------------------
# NOTE: Add these lines on a new blank line before the preceding line(s) to find. 
#
<!-- // MOD : ABBC3 (V1.0.6b) - START -->
<!-- ENDIF -->
<!-- // MOD : ABBC3 (V1.0.6b) - START -->

#
#-----[DIY]----------------------------------------------------------
#
After installation, make sure you purge the cache and refresh all the styles through the ACP to get everything to show up correctly.

Added Giant font size (you must go ACP -> General Tab -> Board configuration -> Post settings
	look at "Maximum font size per post: Maximum font size allowed in a post. Set to 0 for unlimited font size." 
	and change "200" value with "300"

New config, you can enable/disable each one tags, regardless. 
	By default all are enables please open includes/abbcode.php and look at $abbcode_config = array()

Added wizard examples, 
	Please open language/en/mods/abbcode.php and look at all 'ABBCODE_?????_NOTE'		=> and add/change to your own examples ;)

#
#-----[ SAVE/CLOSE ALL FILES ]---------------------------------------
#
# EoM